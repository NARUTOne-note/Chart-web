# 音视频

## 音频

> 声音是由物体振动产生的，振动的快慢(频率)决定了声音的音调(男高音，男低音)，振动的幅度决定了声音的大小（音量|响度），振动的物体的特性决定了声音的音色。**音调、音量和音色称为声音的三要素**

- 声音可以用模拟信号来表示的 (模拟信号是指用连续变化的物理量表示的信息，其信号的幅度，或频率，或相位随时间作连续变化，或在一段连续的时间间隔内，其代表信息的特征量可以在任意瞬间呈现为任意数值的信号。)
- FFMPE是音视频处理最常用的开源软件。

### 编码

> 编码就是按照一定的格式记录采样和量化之后的数据；音频码率=采样大小*采样率*声道

音频的原始数据是**PCM数据，Pulse Code Modulation**，包含以下内容：

- 采样大小：一个采样用多少bit存放，常用的16bit,采样大小越大
- 采样率：1s采样多少次
- 声道数：左声道、右声道，双声道

## 视频

> 其实就是一系列连续播放的图片，其中一张图片称为一帧，1s播放的图片数称为帧率。常见的帧率有24帧/s，30帧/s,32帧/s。

- 视频是由图片构成的，图片是由像素构成的。
- 每个像素由RGB构成，每个8位，共24位。
- 像素用16进制表示为 #ffffff，需要6个16进制，也就是3byte
- 帧率和分辨率都可以影响视频体积，但是帧率是主要因素，在工作中如果看到一个很短的视频非常大，很大可能性是因为帧率很大，为了便于网络传输，需要降低帧率。一般来说主流视频平台的帧率在1Mbit/s左右。

### 帧率FPS

> 每秒显示的帧数，就是1s播放的图片数量(Frames per Second)。

由于人类眼睛的特殊生理结构，如果所看画面之帧率高于24的时候，就会认为是连贯的，此现象称之为**视觉暂留**。这也就是为什么电影胶片是一格一格拍摄出来，然后快速播放的。
而对游戏，一般来说，第一人称射击游戏比较注重FPS的高低，如果FPS<30的话，游戏会显得不连贯。所以有一句有趣的话：“FPS（指FPS游戏）重在FPS（指帧率）。
**每秒的帧数(fps)或者说帧率表示图形处理器处理场时每秒钟能够更新的次数**。高的帧率可以得到更流畅、更逼真的动画。一般来说30fps就是可以接受的，但是将性能提升至60fps则可以明显提升交互感和逼真感，但是一般来说超过75fps一般就不容易察觉到有明显的流畅度提升了。如果帧率超过屏幕刷新率只会浪费图形处理的能力，因为监视器不能以这么快的速度更新，这样超过刷新率的帧率就浪费掉了。


### 分辨率

> 显示分辨率（屏幕分辨率）是屏幕图像的精密度，是指显示器所能显示的像素有多少。由于屏幕上的点、线和面都是由像素组成的，显示器可显示的像素越多，画面就越精细，同样的屏幕区域内能显示的信息也越多，所以分辨率是个非常重要的性能指标之一。可以把整个图像想象成是一个大型的棋盘，而分辨率的表示方式就是所有经线和纬线交叉点的数目。显示分辨率一定的情况下，显示屏越小图像越清晰，反之，显示屏大小固定时，显示分辨率越高图像越清晰。

例如：常见的1920 * 1080p，是指屏幕竖直方向有1080个像素，共有1920列

分辨率对视频体积有一定影响，但是**不是分辨率越大，视频越清晰，还要看码率。**

### 码率（比特率）

> 帧率是1S播放多少帧，类比一下，比特率就是1s的视频有多少bit。这个参数决定了视频是否清晰。

一个1080P的视频，大小可以为1G，也可以为4G，视频越大，说明1S存放的数据越多，比特率越高，压缩比越小，视频越清晰

### 视频压缩

视频和图片具有以下特点:

空间冗余：图像的相邻像素之间有较强的相关性，一张图片相邻像素往往是渐变的，不是突变的，没必要每个像素都完整地保存，可以隔几个保存一个，中间的用算法计算出来。
时间冗余：视频序列的相邻图像之间内容相似。一个视频中连续出现的图片也不是突变的，可以根据已有的图片进行预测和推断。
视觉冗余：人的视觉系统对某些细节不敏感，因此不会每一个细节都注意到，可以允许丢失一些数据。
编码冗余：不同像素值出现的概率不同，概率高的用的字节少，概率低的用的字节多，类似霍夫曼编码（Huffman Coding）的思路。

编码压缩思路：

- 帧内预测：去除空间冗余
- 帧间预测：去除时间冗余
- 变换：去除空间冗余
- 量化：去除视觉冗余，通过降低图像质量，提高压缩比
- 熵编码：去除编码冗余，变长编码

经过编码之后，视频由一帧帧的图片，变成了一串串让人看不懂的二进制代码，因为编码的方式(算法)的不同，所以就有了编码格式的区分。常见的编码格式有 H.264,MPEG-4,VP8等。

**主流浏览器支持的视频编码格式是h264**

### 封装格式

> 把视频数据、音频数据打包到一起，然后再添加一些基本信息，例如分辨率、时长、标题等，构成一个文件，这个文件称为封装格式。常见的封装格式有MP4,MOV,MPEG,WEBM等